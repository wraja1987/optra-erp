{
  "name": "optra-erp",
  "private": true,
  "packageManager": "pnpm@9.0.0",
  "workspaces": [
    "apps/*",
    "packages/*"
  ],
  "scripts": {
    "dev:fast": "pnpm --filter web dev",
    "smoke:web": "pnpm --filter web build && node -e \"console.log('web build ok')\"",
    "smoke:mobile": "pnpm --filter mobile test || echo 'mobile smoke placeholder ok'",
    "lint": "eslint . --ext .js,.ts,.tsx --max-warnings=0",
    "typecheck": "tsc -p tsconfig.base.json --noEmit",
    "test": "vitest run --reporter=dot",
    "cov": "vitest run --coverage --reporter=dot",
    "a11y": "echo 'axe-core placeholder'",
    "ui:a11y": "bash scripts/ui/a11y.sh light",
    "ui:a11y:dark": "bash scripts/ui/a11y.sh dark",
    "ui:perf": "bash scripts/ui/perf.sh",
    "ui:nav:lint": "node scripts/ui/nav-lint.js",
    "ui:visual": "bash scripts/ui/visual.sh",
    "test:security": "bash scripts/security/test-security.sh",
    "sbom": "npx --yes cyclonedx-bom -o sbom.xml || echo 'sbom stub'",
    "gate:phase0": "node scripts/gate-phase0.cjs",
    "prisma:generate": "npx prisma generate",
    "prisma:validate": "npx prisma validate",
    "db:up": "docker compose up -d",
    "db:down": "docker compose down -v",
    "health": "node -r dotenv/config scripts/healthcheck.cjs",
    "gate:phase1": "node scripts/gate-phase1.cjs",
    "gate:phase2": "node scripts/gates/phase2.cjs",
    "gate:phase3": "node scripts/gates/phase3.cjs",
    "gate:phase4": "bash scripts/ci/gate-phase4.sh",
    "gate:phase5": "node scripts/gates/phase5.cjs",
    "report:phase5": "bash scripts/ci/phase5-summary.sh",
    "gates:phase4": "bash scripts/ci/gate-phase4.sh",
    "gates:all": "npm run gate:phase0 && npm run gate:phase1 && npm run gate:phase2 && npm run gate:phase3 && npm run gate:phase4 && npm run gate:phase5",

    "web": "npm --workspace apps/web run dev",
    "check": "npm run health && npm run gates:all",
    "build": "pnpm -r run build",
    "dev:web": "pnpm --filter web dev",
    "openapi:generate": "node scripts/docs/publish-openapi.js",
    "sdk:build": "pnpm -C packages/sdk-optra build",
    "golden:invoice": "node scripts/tests/golden-invoice.js",
    "golden:siem": "node scripts/tests/golden-siem.js",
    "golden:all": "pnpm -w golden:invoice && pnpm -w golden:siem",
    "seed:phase4": "tsx scripts/seeds/seed-phase4.ts",
    "seed:phase4:demo-off": "tsx scripts/seeds/seed-phase4.ts --disableDemo",
    "test:cov": "vitest run --coverage --reporter=dot"
  },
  "devDependencies": {
    "@types/node": "^20.14.11",
    "@vitest/coverage-v8": "^3.2.4",
    "eslint": "^8.57.0",
    "eslint-config-prettier": "^9.1.0",
    "eslint-plugin-import": "^2.29.1",
    "eslint-plugin-jsdoc": "^48.3.0",
    "eslint-plugin-n": "^17.9.0",
    "eslint-plugin-promise": "^6.4.0",
    "prettier": "^3.3.3",
    "prisma": "^6.14.0",
    "typescript": "^5.5.4",
    "vitest": "3.2.4",
    "zod": "^3.23.8",
    "tsx": "4.20.4",
    "wait-on": "^7.0.1",
    "start-server-and-test": "^2.0.3"
  },
  "eslintConfig": {
    "env": {
      "es2021": true,
      "node": true
    },
    "extends": [
      "eslint:recommended",
      "plugin:promise/recommended",
      "plugin:n/recommended",
      "prettier"
    ],
    "parserOptions": {
      "ecmaVersion": "latest",
      "sourceType": "script"
    },
    "ignorePatterns": [
      "node_modules/",
      "dist/",
      "sbom.xml",
      "apps/**",
      "packages/**",
      "scripts/**",
      "vitest.config.ts"
    ],
    "overrides": [
      {
        "files": [
          "**/*.test.js"
        ],
        "parserOptions": {
          "sourceType": "module"
        }
      }
    ]
  },
  "vitest": {
    "test": {
      "environment": "node",
      "exclude": [
        "**/node_modules/**",
        "apps/web/node_modules/**",
        "apps/mobile/**"
      ]
    },
    "coverage": {
      "provider": "v8",
      "exclude": [
        "scripts/**"
      ],
      "thresholds": {
        "lines": 80,
        "branches": 70,
        "functions": 80,
        "statements": 80
      }
    },
    "globals": true
  },
  "dependencies": {
    "@prisma/client": "^6.14.0",
    "pg": "^8.16.3",
    "redis": "^5.8.1"
  }
}

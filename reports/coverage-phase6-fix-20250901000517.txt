
> nexa-erp@ cov /Users/waheedraja/Projects/optra-erp
> vitest run --coverage --reporter=dot


 RUN  v3.2.4 /Users/waheedraja/Projects/optra-erp
      Coverage enabled with v8

Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > masks sensitive fields and responds ok
[assistant_audit] {
  ip: [32m'loca****'[39m,
  session: [32m'loca****'[39m,
  route: [32m'/dashboard'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

stdout | apps/web/src/app/api/assistant/route.test.ts > assistant route > rate limits excessive calls
[assistant_audit] {
  ip: [32m'1.xxx.xxx.xxx'[39m,
  session: [32m'1.xxx.xxx.xxx'[39m,
  route: [32m'/x'[39m,
  hasMasked: [33mtrue[39m
}

Â·Â·Â·Â·Â·

 Test Files  9 passed (9)
      Tests  19 passed (19)
   Start at  00:05:18
   Duration  1.34s (transform 128ms, setup 0ms, collect 377ms, tests 55ms, environment 2ms, prepare 1.51s)

 % Coverage report from v8
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |   11.45 |     36.2 |      20 |   11.45 |                   
 optra-erp         |       0 |        0 |       0 |       0 |                   
  ...ind.config.js |       0 |        0 |       0 |       0 | 1-30              
 .../src/analytics |       0 |        0 |       0 |       0 |                   
  nlq.service.js   |       0 |        0 |       0 |       0 | 1-10              
  ...er.service.js |       0 |        0 |       0 |       0 | 1-8               
 ...pi/src/billing |       0 |        0 |       0 |       0 |                   
  ...ng.service.js |       0 |        0 |       0 |       0 | 1-5               
 ...ps/api/src/clm |       0 |        0 |       0 |       0 |                   
  ...ts.service.js |       0 |        0 |       0 |       0 | 1-7               
 ...ps/api/src/crm |       0 |        0 |       0 |       0 |                   
  cpq.service.js   |       0 |        0 |       0 |       0 | 1-3               
 .../src/devportal |       0 |        0 |       0 |       0 |                   
  ...al.service.js |       0 |        0 |       0 |       0 | 1-14              
 ...c/fieldservice |       0 |        0 |       0 |       0 |                   
  ...st.service.js |       0 |        0 |       0 |       0 | 1-5               
 ...rc/marketplace |       0 |        0 |       0 |       0 |                   
  ...st.service.js |       0 |        0 |       0 |       0 | 1-17              
  ...ls.service.js |       0 |        0 |       0 |       0 | 1-3               
  ...nt.service.js |       0 |        0 |       0 |       0 | 1-5               
 ...ps/api/src/mfg |       0 |        0 |       0 |       0 |                   
  bom.service.js   |       0 |        0 |       0 |       0 | 1-19              
  ...gy.service.js |       0 |        0 |       0 |       0 | 1-10              
  mrp.service.js   |       0 |        0 |       0 |       0 | 1-15              
  wo.service.js    |       0 |        0 |       0 |       0 | 1-11              
 ...src/monitoring |       0 |        0 |       0 |       0 |                   
  ...ng.service.js |       0 |        0 |       0 |       0 | 1-6               
 ...i/src/projects |       0 |        0 |       0 |       0 |                   
  ...ng.service.js |       0 |        0 |       0 |       0 | 1-3               
 ...pi/src/quality |       0 |        0 |       0 |       0 |                   
  ...ty.service.js |       0 |        0 |       0 |       0 | 1-8               
 ...i/src/treasury |       0 |        0 |       0 |       0 |                   
  ...ry.service.js |       0 |        0 |       0 |       0 | 1-4               
 ...ps/api/src/wms |       0 |        0 |       0 |       0 |                   
  ...ry.service.js |       0 |        0 |       0 |       0 | 1-20              
 ...rp/apps/mobile |       0 |        0 |       0 |       0 |                   
  App.tsx          |       0 |        0 |       0 |       0 | 1-76              
 ...pps/mobile/src |       0 |      100 |     100 |       0 |                   
  registry.ts      |       0 |      100 |     100 |       0 | 3-14              
 ...a-erp/apps/web |       0 |      100 |     100 |       0 |                   
  next.config.ts   |       0 |      100 |     100 |       0 | 3-7               
 ...ps/web/src/app |       0 |        0 |       0 |       0 |                   
  fonts.ts         |       0 |        0 |       0 |       0 | 1-13              
  layout.tsx       |       0 |        0 |       0 |       0 | 1-19              
  page.tsx         |       0 |        0 |       0 |       0 | 1-23              
 .../src/app/(app) |       0 |        0 |       0 |       0 |                   
  layout.tsx       |       0 |        0 |       0 |       0 | 1-14              
 .../ai/audit-logs |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 .../(app)/ai/runs |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...)/ai/workflows |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...orkflows/start |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-8               
 ...lling/invoices |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 .../billing/plans |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 .../subscriptions |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...app)/dashboard |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...)/dev/api-keys |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...p)/dev/openapi |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...)/dev/webhooks |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 .../consolidation |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...prise/entities |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...e/intercompany |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...app/(app)/help |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...y/construction |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...stry/logistics |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 .../manufacturing |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...ional-services |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...ndustry/retail |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...stry/saas-tech |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...rations/amazon |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...egrations/ebay |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...tegrations/edi |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...rations/health |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...tions/hmrc-rti |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...s/open-banking |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...ations/shopify |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...ations/toggles |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-9               
 ...toring/backups |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...itoring/health |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...itoring/status |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...tings/entities |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...tings/security |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...ttings/tenants |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-10              
 ...c/app/(public) |       0 |        0 |       0 |       0 |                   
  layout.tsx       |       0 |        0 |       0 |       0 | 1-10              
 ...orgot-password |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-17              
 ...(public)/login |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-21              
 .../api/assistant |   94.73 |    89.47 |     100 |   94.73 |                   
  route.ts         |   94.73 |    89.47 |     100 |   94.73 | 36-37             
 ...pp/api/healthz |       0 |        0 |       0 |       0 |                   
  route.ts         |       0 |        0 |       0 |       0 | 1-5               
 ...stration/start |       0 |        0 |       0 |       0 |                   
  route.ts         |       0 |        0 |       0 |       0 | 1-28              
 ...app/api/readyz |       0 |        0 |       0 |       0 |                   
  route.ts         |       0 |        0 |       0 |       0 | 1-3               
 ...urchase-orders |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-17              
 .../app/themetest |       0 |        0 |       0 |       0 |                   
  page.tsx         |       0 |        0 |       0 |       0 | 1-14              
 ...src/components |       0 |        0 |       0 |       0 |                   
  AiLoader.tsx     |       0 |        0 |       0 |       0 | 1-15              
  Header.tsx       |       0 |        0 |       0 |       0 | 1-22              
  Nav.tsx          |       0 |        0 |       0 |       0 | 1-35              
  ThemeToggle.tsx  |       0 |        0 |       0 |       0 | 1-15              
 ...web/src/config |       0 |      100 |     100 |       0 |                   
  modules.ts       |       0 |      100 |     100 |       0 | 9-110             
 ...eb/src/lib/log |     100 |       80 |     100 |     100 |                   
  mask.ts          |     100 |       80 |     100 |     100 | 2                 
 .../web/src/types |     100 |      100 |     100 |     100 |                   
  phase6.ts        |     100 |      100 |     100 |     100 |                   
 ...kages/core/src |     100 |     87.5 |     100 |     100 |                   
  index.js         |     100 |     87.5 |     100 |     100 | 14                
 ...re/src/finance |   96.66 |    73.52 |     100 |   96.66 |                   
  bankImport.js    |     100 |    71.42 |     100 |     100 | 7,16-17,20        
  ...nalService.js |   94.44 |       75 |     100 |   94.44 | 15-16             
 ...re/src/payroll |   78.46 |    43.75 |   66.66 |   78.46 |                   
  payrollEngine.js |   78.46 |    43.75 |   66.66 |   78.46 | ...-8,10-12,27-30 
 .../sdk-nexa/dist |      20 |      100 |       0 |      20 |                   
  index.js         |      20 |      100 |       0 |      20 | 3-6,8-19          
 ...s/sdk-nexa/src |   22.22 |      100 |       0 |   22.22 |                   
  index.ts         |   22.22 |      100 |       0 |   22.22 | 8-10,13-23        
 optra-erp/scripts |       0 |        0 |       0 |       0 |                   
  gate-phase0.cjs  |       0 |        0 |       0 |       0 | 1-20              
  gate-phase1.cjs  |       0 |        0 |       0 |       0 | 1-39              
  healthcheck.cjs  |       0 |        0 |       0 |       0 | 1-34              
  ...o-6-audit.cjs |       0 |        0 |       0 |       0 | 1-34              
  rename-audit.cjs |       0 |        0 |       0 |       0 | 1-45              
  ...-gap-scan.cjs |       0 |        0 |       0 |       0 | 1-35              
 ...p/scripts/docs |       0 |        0 |       0 |       0 |                   
  ...sh-openapi.js |       0 |        0 |       0 |       0 | 1-30              
 .../scripts/gates |       0 |        0 |       0 |       0 |                   
  phase2.cjs       |       0 |        0 |       0 |       0 | 1-64              
  phase3.cjs       |       0 |        0 |       0 |       0 | 1-43              
  phase5.cjs       |       0 |        0 |       0 |       0 | 1-69              
 ...scripts/phase6 |       0 |        0 |       0 |       0 |                   
  acceptance.cjs   |       0 |        0 |       0 |       0 | 1-140             
 .../scripts/seeds |       0 |        0 |       0 |       0 |                   
  seed-phase4.ts   |       0 |        0 |       0 |       0 | 1-133             
  seed-phase6.ts   |       0 |        0 |       0 |       0 | 1-32              
 .../scripts/tests |       0 |        0 |       0 |       0 |                   
  ...en-invoice.js |       0 |        0 |       0 |       0 | 1-13              
  golden-siem.js   |       0 |        0 |       0 |       0 | 1-13              
 ...erp/scripts/ui |       0 |        0 |       0 |       0 |                   
  nav-lint.js      |       0 |        0 |       0 |       0 | 1-19              
  run-axe.cjs      |       0 |        0 |       0 |       0 | 1-20              
-------------------|---------|----------|---------|---------|-------------------
